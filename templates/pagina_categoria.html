<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastrar categorias</title>
    <!-- link css -->
    <link rel="stylesheet" href="/static/styles/pagina_categoria.css">
    <!-- link css cores -->
    <link rel="stylesheet" href="/static/styles/variaveis_globais.css">
    <!-- link css global para reset -->
    <link rel="stylesheet" href="/static/styles/global.css">
    <!-- link css header e footer -->
    <link rel="stylesheet" href="/static/styles/header_footer.css">

    <!-- ícones Google Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Link importação do Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>

<body class="container--body">

    <!-- header bootstrap -->
    <header class="container--header">
        <a href="{{ url_for('pagina_principal') }}"><img src="/static/img/logo_InStock-transparente.png" class="img--InStock-logo" alt="InStock Logo"></a>

        <nav class="navbar navbar-expand-lg bg-body-transparent">
            <div class="container-fluid">
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <span class="nav-link active" aria-current="page" >Bem Vindo(a) {{ nome }}</span>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#"><span class="material-symbols-outlined">shopping_cart</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#"><span class="material-symbols-outlined">logout</span></a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

    </header>

    <main class="container--main">

        <h2>Cadastro</h2>
        <div class="container--divisao1">

            <!-- form cadastrar catergoria -->
            <!-- action/method: backend do add categoria -->
            <form action="/post/cadastrar/categoria" method="post" class="container--form container--add-categoria">
                <h2>Adicionar Categoria</h2>

                <!-- nome da categoria -->
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Nome da categoria:</label>
                    <!-- name: backend do adicionar nome da categoria -->
                    <input name="nome" type="text" class="form-control"></input>
                </div>

                <div class="mb-3 form-check">
                    <a href="/cadastrar/categoria"><button type="submit" class="btn btn-primary">Adicionar</button></a>
                </div>
            </form>

            <form action="/post/cadastrar/tipo" method="post" class="container--form">
                <h2>Adicionar Tipo</h2>

                <!-- nome do tipo -->
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Nome do tipo:</label>
                    <!-- name: backend do adicionar nome do tipo -->
                    <input name="nome" type="text" class="form-control"></input>
                </div>

                    <!-- selecionar categoria -->
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Selecione a categoria:</label>
                    <!-- name: backend do adicionar nome da categoria -->
                    <select name="cod_categoria" type="text" class="form-control">
                        <!-- aparece apenas quando não há categoria cadastrada  -->
                        <option value="" disabled selected>Selecione a categoria</option>
                        <!-- puxa as categorias que foram cadastradas no banco de dados para adicionar no select -->
                        {% for categorias in categoria %}
                        <option value="{{categorias.cod_categoria}}">{{categorias.nome}}</option>
                        {% endfor %}
                    </select>

                </div>

                <div class="mb-3 form-check">
                    <a href="/cadastrar/categoria"><button type="submit" class="btn btn-primary">Adicionar</button></a>
                </div>
            </form>

            <form action="/post/cadastrar/caracteristica" method="post" class="container--form" id="caracteristicaForm">
                <h2>Adicionar Características</h2>

                <!-- nome do tipo -->
                <div class="mb-3">
                    <label class="form-label">Nome da característica:</label>
                    <!-- name: backend do adicionar nome da característica -->
                    <input name="nome" type="text" class="form-control"></input>
                </div>

                <!-- selecionar o tipo -->
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Selecione o tipo:</label>
                    <!-- name: backend selecionar nome do tipo -->
                    <select name="cod_tipo" type="text" class="form-control">
                        <option value="" disabled selected>Selecione o tipo</option>
                        {% for tipos in tipo %}
                        <option value="{{tipos.cod_tipo}}">{{tipos.nome}}</option>
                        {% endfor %}

                    </select>
                </div>

                <div class="mb-3 form-check">
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
            </form>
        </div>


        <!-- divisão 2: exclusao de categorias, tipos e características -->
         <h2>Exclusão</h2>
         <div class="container--divisao2">
            
            <!-- categorias -->
            <div class="container--exclusao">
                <h2 class="titulo-exclusao">Excluir categorias</h2>
                {% for categorias in categoria %}
                <div class="container--exclusao-itens">
                    <label for="">{{categorias.nome}}</label>
                    <a href="/post/remover/categoria/{{categorias.cod_categoria}}"><span class="material-symbols-outlined">delete</span></a>
                </div>
                {% endfor %}
            </div>

            <!-- tipos -->
            <div class="container--exclusao">
                <h2 class="titulo-exclusao">Excluir tipos</h2>
                {% for tipos in tipo %}
                <div class="container--exclusao-itens">
                    <label for="">{{tipos.nome}}</label>
                    <a href="/post/remover/tipo/{{tipos.cod_tipo}}"><span class="material-symbols-outlined">delete</span></a>
                </div>
                {% endfor %}
            </div>

            <!-- caracteristicas -->
            <div class="container--exclusao">
                <h2 class="titulo-exclusao">Excluir caracteristicas</h2>
                {% for caracteristicas in caracteristica %}
                <div class="container--exclusao-itens">   
                    <label for="">{{caracteristicas.nome}}</label>
                    <a href="/post/remover/caracteristica/{{caracteristicas.cod_caracteristica}}"><span class="material-symbols-outlined">delete</span></a>
                </div>
                {% endfor %}
                
            </div>

         </div>

    </main>

    <footer class="container--footer">
        <!-- inserir mais tarde -->
    </footer>

    <!-- Link importação do Bootstrap Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous">
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="/static/script/sweet_alert_caracteristica.js"></script>

    <!-- <script>
        // Conteúdo do sweet_alert_caracteristica.js, AGORA AQUI
        
        // 1. Pega o formulário de cadastro de característica pelo seu ID
        const caracteristicaForm = document.getElementById('caracteristicaForm');

        // Verifica se o formulário existe na página antes de anexar o ouvinte
        if (caracteristicaForm) {
            
            // 2. Adiciona o 'ouvinte' para o evento 'submit'
            caracteristicaForm.addEventListener('submit', function(event) {

                // *** CRÍTICO: Previne o envio síncrono padrão do formulário ***
                event.preventDefault(); 

                // 3. Coleta os dados do formulário
                const formData = new FormData(caracteristicaForm);

                // 4. Inicia a requisição assíncrona (AJAX)
                fetch(caracteristicaForm.action, {
                    method: 'POST', 
                    body: formData 
                })
                .then(response => {
                    // Trata a resposta HTTP, garantindo que pegamos o JSON interno.
                    return response.json().then(data => ({
                        status: response.status,
                        data: data
                    }));
                })
                .then(({ status, data }) => {
                    // 5. Processa a resposta final do servidor
                    
                    // SUCESSO: Status HTTP 200 E status JSON 'success'
                    if (status === 200 && data.status === "success") {
                        
                        // --- SWEET ALERT AUTOMÁTICO (TIMER) ---
                        Swal.fire({
                            title: 'Cadastro Realizado com Sucesso! 🎉',
                            text: `${data.message} A página será recarregada em 3 segundos.`,
                            icon: 'success',
                            timer: 3000,                
                            timerProgressBar: true,     
                            showConfirmButton: false    
                        }).then(() => {
                            // Este bloco é executado quando o timer termina.
                            window.location.reload(); 
                        });

                    } else {
                        // ERRO: 4xx, 5xx ou status 'error'
                        
                        Swal.fire({
                            title: 'Falha no Cadastro! 😥',
                            text: data.message || 'Erro desconhecido ao processar a requisição.', 
                            icon: 'error',
                            confirmButtonText: 'Tentar Novamente'
                        });
                    }
                })
                .catch(error => {
                    // Falhas de rede/conexão
                    console.error('Erro de rede ou processamento:', error);
                    
                    Swal.fire({
                        title: 'Ops! Erro de Comunicação ⚠️',
                        text: 'Não foi possível conectar ao servidor. Tente novamente.', 
                        icon: 'warning',
                        confirmButtonText: 'Entendi'
                    });
                });
            });
        }
    </script> -->

</body>

</html>